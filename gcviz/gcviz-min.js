/*!
 *
 * GeoCanViz viewer / Visionneuse GÃ©oCanViz
 * gcviz.github.io/gcviz/License-eng.txt / gcviz.github.io/gcviz/Licence-fra.txt
 *
 * Version: v0.0.1-development Build: 2014-12-17- 02:36 PM
 *
 */
var locationPath;(function(){var b,a;define(["jquery-private","magnificpopup","jqueryui","gcviz-i18n","gcviz-func","gcviz-v-map","gcviz-v-inset","gcviz-v-help","gcviz-v-wcag","gcviz-v-datagrid","gcviz-v-header","gcviz-v-footer","gcviz-v-tbdraw","gcviz-v-tbnav","gcviz-v-tblegend","gcviz-v-tbdata"],function(u,r,v,l,x,w,p,s,j,i,t,o,f,m,g,q){var c,d,k,e,n,h;c=function(){var A,z,B=u(".gcviz"),y=B.length;u.extend(true,u,$);b=y;a=0;z=document.getElementsByTagName("body")[0];z.className=z.className+" "+window.browser;e();n();h();while(y--){A=B[y];d(A)}};d=function(z){var y=z.getAttribute("data-gcviz");u.support.cors=true;u.ajax({url:y,crossDomain:true,dataType:"json",async:false,success:function(A){A.gcviz.mapframe.id=z.getAttribute("id");k(z,A.gcviz);console.log(l.getDict("%msg-configread"))},error:function(){console.log(l.getDict("%msg-configerr")+": "+y)}})};k=function(E,z){var B,A=u(E),D=z.mapframe,C=D.id,H=D.size,y=H.width,G={},F=parseInt(A.parent().css("width"),10)-(2*A.position().left);if(F<H.width){y=F}A.wrap("<section id=section"+C+' class="gcviz-section" role="map" style="width:'+y+"px; height:"+(H.height+116)+'px;">');B=u(document).find("#section"+C);u.extend(B,z);G.map=w.initialize(B,y);x.setVM(C,G);G.wcag=j.initialize(B);G.header=t.initialize(B);G.footer=o.initialize(B);if(z.datagrid.enable){G.datagrid=i.initialize(B)}if(z.toolbardraw.enable){G.draw=f.initialize(B)}if(z.toolbarnav.enable){G.nav=m.initialize(B)}if(z.toolbarlegend.enable){G.legend=g.initialize(B)}if(z.toolbardata.enable){G.data=q.initialize(B)}if(z.insetframe.enable){G.insets=p.initialize(B)}G.help=s.initialize(B);x.setVM(C,G);a+=1;if(a===b){window.onresize=x.debounce(function(J){var N,K,P,M,S,Q=$(J.target.document.getElementsByClassName("gcviz-section")),I=Q.find(".gcviz"),R=Q.find(".gcviz-map"),L=Q.find(".gcviz-root"),O=I.hasClass("gcviz-sectionfs");if(O){S=window.innerWidth}else{K=parseInt(B.css("width"),10),P=parseInt(R.attr("gcviz-size").split(";")[1],10),M=Q.position().left,S=parseInt(Q.parent().css("width"),10)-(2*M)}if(S<360){S=360}if(P>S||O){N=S}else{if(K<P&&S>P){N=P}}x.setStyle(Q[0],{width:N+"px"});x.setStyle(I[0],{width:N+"px"});x.setStyle(R[0],{width:N+"px"});x.setStyle(L[0],{width:N+"px"})},200,false)}};e=function(){var B=document.getElementsByTagName("meta"),z=B.length;while(z--){if(B[z].getAttribute("property")==="location"){locationPath=B[z].getAttribute("content")}}if(typeof locationPath==="undefined"){var y=window.location.toString(),A=y.search("GeoCanViz");if(A!==-1){locationPath=y.substring(0,y.search("GeoCanViz"))+"GeoCanViz/"}}};n=function(){u.extend(true,$.magnificPopup.defaults,{tClose:l.getDict("%mp-close"),tLoading:l.getDict("%mp-load"),gallery:{tPrev:l.getDict("%mp-prev"),tNext:l.getDict("%mp-next"),tCounter:l.getDict("%mp-count")},image:{tError:l.getDict("%mp-error")}})};h=function(){u.fn.scrollTo=function(A,y,B){var z;if(typeof y==="function"&&arguments.length===2){B=y;y=A}z=$.extend({scrollTarget:A,offsetTop:26,duration:500,easing:"swing"},y);return this.each(function(){var C=$(this),D=(typeof z.scrollTarget==="number")?z.scrollTarget:$(z.scrollTarget),E=(typeof D==="number")?D:(D.offset().top-C.offset().top)+C.scrollTop()-parseInt(z.offsetTop,10);C.animate({scrollTop:E},parseInt(z.duration,10),z.easing,function(){if(typeof B==="function"){B.call(this)}})})}};return{initialize:c}})}).call(this);