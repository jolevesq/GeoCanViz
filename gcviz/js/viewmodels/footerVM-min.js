(function(){define(["jquery-private","knockout","gcviz-i18n","gcviz-func","gcviz-gisgeo","gcviz-gisnav"],function(d,e,g,h,b,c){var a,f;a=function(l,i,j){var k=function(o,s,n){var t=this,q=locationPath+"gcviz/images/GCVizLogo.png",m=n.mousecoords,u=n.northarrow,r=n.scalebar,v=u.inwkid,p=m.outwkid;t.mapid=s;t.imgLogoPNG=q;t.tpFormat=g.getDict("%footer-tpformat");t.urlLogo=g.getDict("%footer-urlgcvizrepo");t.urlLogoAlt=g.getDict("%footer-tpgithub");t.lblWest=g.getDict("%west");t.lblPosition=g.getDict("%position");t.tpDatagrid=g.getDict("%footer-tpdatagrid");t.tpArrow=g.getDict("%footer-tpNorth");t.coords1=e.observable("");t.coords2=e.observable("");t.dualCoords=e.observable(0);t.rotateArrow=e.observable("");t.isTableReady=e.observable(false);t.init=function(){var w=h.getElemValueVM(s,["map","map"],"js");if(m.enable){w.on("mouse-move",function(x){t.showCoordinates(x)})}if(u.enable){b.getNorthAngle(w.extent,v,t.updateArrow);w.on("pan-end",function(x){t.showNorthArrow(x)});w.on("zoom-end",function(x){t.showNorthArrow(x)})}if(r.enable){c.setScaleBar(w,r)}return{controlsDescendantBindings:true}};t.showCoordinates=function(w){b.projectPoints([w.mapPoint],p,t.updateCoordinates)};t.updateCoordinates=function(C){var G,E,B,F="",w="",D=C[0],A=D.x,z=D.y;if(p===4326){t.dualCoords(1);B=h.convertDdToDms(A,z,0);E=B.y.join(" ");G=B.x.join(" ");if(A<0){F=(-1*A.toFixed(3)).toString()+" "+t.lblWest}else{F=A.toFixed(3).toString()+" E"}if(z<0){w=(-1*z.toFixed(3)).toString()+" S"}else{w=z.toFixed(3).toString()+" N"}t.coords2(w+" | "+F)}else{G="X= "+A.toFixed(3).toString();E="Y= "+z.toFixed(3).toString()}t.coords1(t.lblPosition+E+" | "+G)};t.showNorthArrow=function(w){b.getNorthAngle(w.extent,v,t.updateArrow)};t.updateArrow=function(E){var z,B,A,D,C,G,F,w={x:-100,y:90};G=E[0];z=(G.x-w.x)*Math.PI/180;B=w.y*Math.PI/180;A=G.y*Math.PI/180;C=Math.sin(z)*Math.cos(A);D=Math.cos(B)*Math.sin(A)-Math.sin(B)*Math.cos(A)*Math.cos(z);F=Math.atan2(C,D)*180/Math.PI;F=((F+360)%360).toFixed(1)-90;t.rotateArrow("rotate("+F+"deg)")};t.datagridClick=function(){var w=d("#gcviz-datagrid"+s);if(w.accordion("option","active")===0){w.accordion({active:false}).click()}else{w.accordion({active:0}).click()}return false};t.goGitHub=function(x,w){if(w.keyCode===13){window.open(t.urlLogo,"_blank")}};t.init()};f=new k(l,i,j);e.applyBindings(f,l[0]);return f};return{initialize:a}})}).call(this);